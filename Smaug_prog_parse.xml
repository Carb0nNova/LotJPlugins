<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, February 22, 2009, 9:54 PM -->
<!-- MuClient version 4.35 -->

<!-- Plugin "Smaug_prog_parse" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Smaug_prog_parse"
   author="Zeno"
   id="ec235cde57534866595eed2a"
   language="Lua"
   purpose="Parses Smaug progs (colors, ifcheck matching, etc)"
   date_written="2009-02-22 21:53:24"
   requires="4.35"
   version="1.0"
   >

</plugin>

<!--  Triggers -->

<triggers>

  <trigger
   custom_colour="17"
   enabled="y"
   match="^[\s]*break$"
   regexp="y"
   sequence="100"
   other_text_colour="firebrick"
  >
  </trigger>

  <trigger
   custom_colour="17"
   enabled="y"
   match="^[\s]*mp[\S]* "
   regexp="y"
   sequence="100"
   other_text_colour="violet"
  >
  </trigger>

  <trigger
   custom_colour="17"
   enabled="y"
   match="^&gt;(.*?)_prog (.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
   other_text_colour="coral"
  >
  <send>inprog = true
</send>
  </trigger>

  <trigger
   custom_colour="17"
   enabled="y"
   match="^[\s]*if (?P&lt;ifcheck&gt;.*?)$"
   regexp="y"
   send_to="12"
   sequence="100"
   other_text_colour="deepskyblue"
  >
  <send>if inprog then
 indentnum = indentnum + 1
 ifchecklist[indentnum] = "%&lt;ifcheck&gt;"
end</send>
  </trigger>

  <trigger
   enabled="y"
   match="^[\s]*endif$"
   omit_from_output="y"
   regexp="y"
   script="SendEndifNote"
   sequence="100"
  >
  </trigger>

  <trigger
   enabled="y"
   match="^\s*$"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>if inprog then
 indentnum = 0
 inprog = false
end</send>
  </trigger>

  <trigger
   enabled="y"
   match="^[\s]*else$"
   omit_from_output="y"
   regexp="y"
   script="SendElseNote"
   send_to="12"
   sequence="100"
  >
  </trigger>

</triggers>

<aliases>

<alias name="togglecomments" match="progcomments" ignore_case="y" enabled="y" send_to="12" sequence="100">
	<send>if comments then
	comments = false
	ColourNote("red","","Mud Prog Comments are disabled.")
	else
	comments = true
	ColourNote("lime","","Mud Prog Comments are enabled.")
	end</send>
	</alias>
</aliases>


<!--  Script  -->

<script>
<![CDATA[
comments = true
inprog = false
indentnum = 0
ifchecks = 0
ifchecklist = {}
indents = {}

require "tprint"

function SendElseNote (name, line, args)
 ColourTell("deepskyblue", "black", args[0])
 if comments then
 	ColourNote("green", "black", " -- if "..ifchecklist[indentnum])
 else
 	Note("")
 end
end -- function

function SendEndifNote (name, line, args)
 ColourTell("deepskyblue", "black", args[0])
 if comments then
 	ColourNote("green", "black", " -- if "..ifchecklist[indentnum])
 else
 	Note("")
 end
if inprog then
 indentnum = indentnum - 1
end
end -- function

]]>
</script>


</muclient>